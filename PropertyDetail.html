<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />
    <title>楼盘详情</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="assets/css/bootstrap.css" />
    <link rel="stylesheet" href="components/font-awesome/css/font-awesome.css" />

    <!-- text fonts -->
    <link rel="stylesheet" href="assets/css/ace-fonts.css" />

    <!-- ace styles -->
    <link rel="stylesheet" href="assets/css/ace.css" class="ace-main-stylesheet" id="main-ace-style" />


    <link rel="stylesheet" href="assets/css/ace-skins.css" />
    <link rel="stylesheet" href="assets/css/ace-rtl.css" />


    <!-- ace settings handler -->
    <script src="assets/js/ace-extra.js"></script>

    <style>
        .checkSty_projectInfo {
            float: left;
        }

        /* .tags {
            display: inline-block;
            padding: 4px 6px;
            color: #777;
            vertical-align: middle;
            border: none;
            width: auto;
        }

        .tag {
            max-width: 200px;
            outline: none;
        } */

        .modal_preview {
            display: none;
            background-color: rgba(0, 0, 0, .5);
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }


        .modal_map .modal-content {
            padding: 10px;
        }

        .operate_proInfo {
            position: absolute;
            right: 100px;
            z-index: 100;
        }

        .inpt_width {
            width: 70%;
        }

        .lab_width {
            width: 120px;
        }

        /* 预览 */

        .preBackImg {
            background: url("assets/images/phone@3x.png") no-repeat;
            background-size: 100% 100%;
            width: 310px;
            height: 600px;
            margin: 0 auto;
        }

        .scanShowAll {
            background-color: #F0F0F0;
            /* background-color: rebeccapurple; */
            width: 254px;
            height: 446px;
            margin: 0 auto;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .showDiv {
            width: 100%;
            box-sizing: border-box;
            padding: 10px;
            background-color: white;
            margin-bottom: 10px;
        }

        .showDiv>div {
            min-height: 40px;
            line-height: 40px;
        }

        .showDiv span {
            color: #737373;
            margin-right: 10px;
            font-size: 12px;
            vertical-align: top;
        }

        .showDiv p {
            color: #323232;
            display: inline-block;
            margin: 0;
            font-size: 13px;
            max-width: 130px;
        }

        .showDiv hr {
            margin: 0;
        }
    </style>
</head>

<body class="no-skin">
    <!-- #section:basics/navbar.layout -->
    <div id="header">

    </div>
    <!-- /section:basics/navbar.layout -->
    <div class="main-container" id="main-container">
        <script type="text/javascript">
            try {
                ace.settings.check('main-container', 'fixed')
            } catch (e) {}
        </script>

        <!-- 菜单开始 -->
        <div id="sidebar" class="sidebar responsive ace-save-state"></div>

        <!-- /section:basics/sidebar -->
        <div class="main-content">
            <div class="main-content-inner">
                <div class="breadcrumbs" id="breadcrumbs">
                    <script type="text/javascript">
                        try {
                            ace.settings.check('breadcrumbs', 'fixed')
                        } catch (e) {}
                    </script>
                    <ul class="breadcrumb">
                        <li>
                            <i class="ace-icon fa fa-home home-icon"></i>
                            <a href="#">楼盘字典>楼盘详情</a>
                        </li>
                    </ul>
                    <div class="operate_proInfo">
                        <button class="btn btn-primary preViewBtn">预览</button>
                        <button class="btn btn-danger" id="save">保存</button>
                    </div>
                </div>
                <!-- 内容开始 -->
                <div class="page-content">
                    <div class="row" style="margin-top: 50px;">
                        <div class="col-xs-12">
                            <form class="form-horizontal" role="form">
                                <div class="widget-box">
                                    <div class="widget-header">
                                        <h4 class="smaller">楼盘详情</h4>
                                    </div>
                                    <div class="widget-body">
                                        <div class="widget-main" style="overflow: hidden;">
                                            <div class="col-xs-6" style="padding-left: 100px;">
                                                <div class="form-group">
                                                    <label class="lab_width">*售楼处地址：</label>
                                                    <input class="inpt_width" type="text" id="sale_address" maxlength="100">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">*建筑类型：</label>
                                                    <div class="inpt_width" style="display:inline-block;vertical-align: top;" id="build_type">

                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">*均价（㎡）：</label>
                                                    <input class="inpt_width" type="number" min="0" id="average_price">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">*价格区间（万）：</label>
                                                    <div class="inpt_width" style="display: inline-block;">
                                                        <input type="number" min="0" style="width: 100px;" id="min_price">
                                                        <span>----</span>
                                                        <input type="number" min="0" style="width: 100px;" id="max_price">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">占地面积（㎡）：</label>
                                                    <input class="inpt_width" type="number" min="0" id="floor_space" step="0.01">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">规划户数（户）：</label>
                                                    <input class="inpt_width" type="number" min="0" id="households_num" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">规划车位（个）：</label>
                                                    <input class="inpt_width" type="number" min="0" id="parking_num" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
                                                </div>
                                            </div>

                                            <div class="col-xs-6" style="padding-left: 50px;">
                                                <div class="form-group">
                                                    <label class="lab_width">设计公司：</label>
                                                    <input class="inpt_width" type="text" id="decoration_company" maxlength="20">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">建筑面积（㎡）：</label>
                                                    <input class="inpt_width" type="number" min="0" id="covered_area" step="0.01">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">容积率：</label>
                                                    <input class="inpt_width" type="number" min="0" id="plot_retio" step="0.1">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">绿化率：</label>
                                                    <input class="inpt_width" type="number" min="0" id="greening_rate">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">装修标准：</label>
                                                    <input class="inpt_width" type="text" id="decoration_standard" maxlength="40">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="widget-box" style="margin-top: 20px;">
                                    <div class="widget-header">
                                        <h4 class="smaller">物业信息</h4>
                                    </div>
                                    <div class="widget-body">
                                        <div class="widget-main" style="overflow: hidden;">
                                            <div class="col-xs-6" style="padding-left: 100px;">
                                                <div class="form-group">
                                                    <label class="lab_width">物业公司：</label>
                                                    <input class="inpt_width" type="text" maxlength="20" id="property_company_name">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">物业费：</label>
                                                    <input class="inpt_width" type="number" min="0" id="property_cost" step="0.1">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">供电类型：</label>
                                                    <input class="inpt_width" type="text" maxlength="10" id="power_supply">
                                                </div>
                                            </div>
                                            <div class="col-xs-6" style="padding-left: 50px;">
                                                <div class="form-group">
                                                    <label class="lab_width">供暖方式：</label>
                                                    <input class="inpt_width" type="text" maxlength="10" id="heat_supply">
                                                </div>
                                                <div class="form-group">
                                                    <label class="lab_width">供水类型：</label>
                                                    <input class="inpt_width" type="text" maxlength="10" id="water_supply">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 预览 -->
    <div class="modal_preview">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="bootbox-close-button close closed">×</button>
                </div>
                <div class="modal-body">
                    <div class="preBackImg" style="padding: 71px 0;">
                        <div class="scanShowAll">
                            <div class="showDiv">
                                <div>
                                    <span>设计公司</span>
                                    <p class="YL_decoration_company"></p>
                                </div>
                                <hr>
                                <div>
                                    <span>售楼处地址</span>
                                    <p class="YL_sale_address"></p>
                                </div>
                            </div>
                            <div class="showDiv">
                                <div>
                                    <span>建筑类型</span>
                                    <p class="YL_build_type"></p>
                                </div>
                                <hr>
                                <div>
                                    <span>均价</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>价格区间</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>占地面颊</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>装修标准</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>建筑面积</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>容积率</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>绿化率</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>规划户数</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>规划车位</span>
                                    <p></p>
                                </div>
                            </div>
                            <div class="showDiv">
                                <div>
                                    <span>物业类型</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>物业公司</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>物业费</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>供暖方式</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>供水类型</span>
                                    <p></p>
                                </div>
                                <hr>
                                <div>
                                    <span>供电类型</span>
                                    <p></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- basic scripts -->

    <!--[if !IE]> -->
    <script src="components/jquery/dist/jquery.js"></script>
    <script type="text/javascript">
        if ('ontouchstart' in document.documentElement) document.write(
            "<script src='components/_mod/jquery.mobile.custom/jquery.mobile.custom.js'>" + "<" + "/script>");
    </script>
    <script src="components/bootstrap/dist/js/bootstrap.js"></script>

    <!-- ace scripts -->
    <script src="assets/js/src/elements.scroller.js"></script>
    <script src="assets/js/src/elements.colorpicker.js"></script>
    <script src="assets/js/src/elements.fileinput.js"></script>
    <script src="assets/js/src/elements.typeahead.js"></script>
    <script src="assets/js/src/elements.wysiwyg.js"></script>
    <script src="assets/js/src/elements.spinner.js"></script>
    <script src="assets/js/src/elements.treeview.js"></script>
    <script src="assets/js/src/elements.wizard.js"></script>
    <script src="assets/js/src/elements.aside.js"></script>
    <script src="assets/js/src/ace.js"></script>
    <script src="assets/js/src/ace.basics.js"></script>
    <script src="assets/js/src/ace.scrolltop.js"></script>
    <script src="assets/js/src/ace.ajax-content.js"></script>
    <script src="assets/js/src/ace.touch-drag.js"></script>
    <script src="assets/js/src/ace.sidebar.js"></script>
    <script src="assets/js/src/ace.sidebar-scroll-1.js"></script>
    <script src="assets/js/src/ace.submenu-hover.js"></script>
    <script src="assets/js/src/ace.widget-box.js"></script>
    <script src="assets/js/src/ace.settings.js"></script>
    <script src="assets/js/src/ace.settings-rtl.js"></script>
    <script src="assets/js/src/ace.settings-skin.js"></script>
    <script src="assets/js/src/ace.widget-on-reload.js"></script>
    <script src="assets/js/src/ace.searchbox-autocomplete.js"></script>

    <script src="assets/js/jquery.cookie.js"></script>
    <script src="assets/js/config.js"></script>
    <script src="assets/js/public.js"></script>

    <!-- 本页js -->
    <script>
        window.onload = function () {
            getConfig();
            $('#header').load('public/header.html');
            $('#sidebar').load('public/menu.html');
            var menu_data = {
                opening: '.loupanzidian',
                acting: '.loupanxiangqing'
            }
            $.cookie('menu_data', JSON.stringify(menu_data), {
                path: "menu.html"
            });
        }

        function getConfig() {
            ajax.get('config', {
                'id': config.configList.BUILD_TYPE
            }, function (res) {
                var model =
                    '<div class="checkbox checkSty_projectInfo"> <label> <input name="form-field-checkbox" type="checkbox" class="ace build_type{build_type_id} build_type" value="{id}" > <span class="lbl"> {name}</span> </label> </div>',
                    str = '';
                $.each(res.data[config.configList.BUILD_TYPE].param, function (k, v) {
                    str += model.replace('{id}', v.id).replace('{name}', v.param).replace(
                        '{build_type_id}', v.id);
                })
                $('#build_type').append(str);
                getProjectInfo();
            })
        }

        function getProjectInfo() {
            ajax.get('provide/project/getProjectInfo', {}, function (res) {
                $('#sale_address').val(res.data.sale_address);
                $('#average_price').val(res.data.average_price);
                $('#min_price').val(res.data.min_price);
                $('#max_price').val(res.data.max_price);
                $('#households_num').val(res.data.households_num);
                $('#parking_num').val(res.data.parking_num);
                $('#decoration_company').val(res.data.decoration_company);
                $('#covered_area').val(res.data.covered_area);
                $('#plot_retio').val(res.data.plot_retio);
                $('#greening_rate').val(res.data.greening_rate);
                $('#decoration_standard').val(res.data.decoration_standard);
                $('#floor_space').val(res.data.floor_space);
                $('#property_company_name').val(res.data.property_company_name);
                $('#property_cost').val(res.data.property_cost);
                $('#heat_supply').val(res.data.heat_supply);
                $('#power_supply').val(res.data.power_supply);
                $('#water_supply').val(res.data.water_supply);
                if (res.data.build_type.length > 0) {
                    $.each(res.data.build_type, function (k, v) {
                        $('.build_type' + v).attr('checked', true);
                        console.log(res.data.build_type);
                    })
                }


                // 预览数据
                $('.YL_sale_address').html(res.data.sale_address);
                $('.YL_decoration_company').html(res.data.decoration_company);
                $('.YL_build_type').html();
            })
        }
        $('#save').click(function () {
            var data = {
                'sale_address': $('#sale_address').val(),
                'average_price': $('#average_price').val(),
                'min_price': $('#min_price').val(),
                'max_price': $('#max_price').val(),
                'households_num': $('#households_num').val(),
                'parking_num': $('#parking_num').val(),
                'decoration_company': $('#decoration_company').val(),
                'covered_area': $('#covered_area').val(),
                'plot_retio': $('#plot_retio').val(),
                'greening_rate': $('#greening_rate').val(),
                'decoration_standard': $('#decoration_standard').val(),
                'property_company_name': $('#property_company_name').val(),
                'property_cost': $('#property_cost').val(),
                'heat_supply': $('#heat_supply').val(),
                'power_supply': $('#power_supply').val(),
                'water_supply': $('#water_supply').val(),
                'floor_space': $('#floor_space').val(),
            }
            if (data.sale_address.length >= 100) {
                alert('售楼处地址过长,请控制在100字之内');
                return false;
            }
            if(data.sale_address==''){
                alert('售楼处地址不能为空');
                return false;
            }


            var checkBoxClass = $('.build_type'),
                list = '';
            $('input[name=form-field-checkbox]:checked').each(function () {
                list += $(this).val() + ',';
            })
            data.build_type = list.slice(0, -1);
            if(data.build_type==''){
                alert('建筑类型不能为空');
                return false;
            }
            ajax.post('project/update', data, function (res) {
                alert(res.msg);
                if (res.code == config.responseSuccess) {
                    window.location.reload();
                }
            })
        })
    </script>
    <script>
        //预览
        $('.preViewBtn').on('click', function (event) {
            event.stopPropagation();

            $('.modal_preview').css('display', 'block');
            return false;
        })
        $('.closed').on('click', function () {
            $(this).parent().parent().parent().parent().css('display', 'none');
        })
    </script>
</body>

</html>